!function(t,e){"use strict";function n(){}function i(t){return t="string"==typeof t?(new DOMParser).parseFromString(t,"text/html"):e,t.nodeType?t.querySelectorAll(o()):void 0}function o(){return"[data-"+w+"]"}function s(t){var e=d?d["byda-"+t]:v?v[t]:"";return e}function r(t,e){d&&(d["byda-"+t]=e),v&&(v.byda[t]=e)}function a(t,i){if(t&&!p)if("string"==typeof t&&(t={file:t}),t.view&&(t.file="views/"+t.view+".html"),t.callback=i||n,t.json={req:"string"==typeof t.json?[{name:"default",file:t.json}]:t.json||[],res:{}},b&&E){var o=e.createElement("link"),s=t.file;m&&(s=m+"/"+s),o.rel="import",o.href=s;var r=e.querySelector('link[href="'+s+'"]');r&&r.remove(),o.onload=function(){t.import=o.import,u(t)},o.onerror=function(){h(t)},e.head.appendChild(o)}else u(t)}function u(t){var e,i=t.json.req[0],o=i?i.file:t.file;if(!o)return t.import?f(t.import,t):_complete(t);s&&s.readyState<4&&(s.onreadystatechange=n,s.abort());var s=new XMLHttpRequest;o=m?m+"/"+o:o,s.open("GET",o,!0),s.setRequestHeader("X-BYDA","true"),s.onreadystatechange=function(){if(4==s.readyState)if(i&&t.json.req.splice(0,1),200==s.status||0===s.status&&-1!=o.indexOf("file:///")){var n=s.responseText;if(!i)return f(n,t);e=JSON.parse(n),"default"==i.name?t.json.res=e:t.json.res[i.name]=e,u(t)}else i&&u(t),h(t)},s.send()}function f(t,e){a.flash().generate(a.flash({dom:t})).run(function(){p=!0,e.callback(a.flash(),e.json.res)},function(){p=!1,y(e)})}function h(t){throw new Error("Could not get: "+t.file)}function l(t,e){this.name=t,this.list=[],this.changes=[],this.value=e||s(t)}function c(t){t||(t={}),this.dom=t.dom,this.numStores=0,this.list=this.dom?i(this.dom):i(),this.frozen=t.frozen,this.organize()}var p,m,d,v,y,b,g={},w="load",E="import"in e.createElement("link");l.prototype.emit=function(){var n,i={detail:{name:this.name,value:this.value},bubbles:!0,cancelable:!0};"function"==typeof CustomEvent?n=new CustomEvent("byda",i):e.createEvent&&(n=e.createEvent("CustomEvent"),n.initCustomEvent("byda",i.bubbles,i.cancelable,i.detail)),t.dispatchEvent(n)},l.prototype.set=function(t,e){var n,i,o,a;for(e&&(o=e.cache),"function"==typeof t?t=t(this.value):"object"==typeof t&&(t=t[this.name]),t||(t=s(this.name)||""),n=0,i=this.list.length;i>n;n++)a=this.list[n],a.hasAttribute("value")?a.value=t:a.innerHTML=t;return this.value=t,o&&r(this.name,this.value),this.emit(),this},l.prototype.get=function(){return this.value},l.prototype.compare=function(t){this.to=t.list[0]},l.prototype.commit=function(t){function e(){t(n.name)}var n=this;if(!this.to)return e();var i,o,r=this.to.nodeType?this.to.value||this.to.innerHTML:this.to,a=this.list,u=this.name;if(r||(r=s(this.name)||""),"function"==typeof g[this.name])for(i=a.length-1;i>=0;i--)o=a[i].cloneNode(!0),o.innerHTML=r,g[u](o,a[i],e);else this.set(r),e()},c.prototype.update=function(){return this.organize(this.dom?i(this.dom):i())},c.prototype.find=function(t){return this.stores[t]},c.prototype.map=function(t){var e;for(var n in t)e=this.stores[n],e&&e.set(t[n]);return this},c.prototype.generate=function(t){var e;for(var n in this.stores)e=t.stores[n],e&&this.stores[n].compare(e);return this},c.prototype.organize=function(t){var e,n,i,o;for(this.stores={},t&&(this.list=t),e=0,n=this.list.length;n>e;e++)i=this.list[e],o=i.getAttribute("data-"+w),this.frozen&&(i=i.cloneNode(!0)),this.stores[o]||(this.stores[o]=new l(o,i.value||i.innerHTML),this.numStores++),this.stores[o].list.push(i);return this},c.prototype.run=function(t,e){function i(t){s.push(t),o.numStores==s.length&&e()}var o=this,s=[];t=t||n,e=e||n;for(var r in this.stores)this.stores[r].commit(i);t()},a.init=function(t){t&&(w="string"==typeof t?t:t.suffix=t.data||w,g=t.buffer,d=t.local,v=t.cache,v&&!v.byda&&(v.byda={}),b=t.imports,m=t.base,y=t.complete||n)},a.base=function(t){return m=t||m},a.flash=function(t){return new c(t)},t.byda=a}(window,document);