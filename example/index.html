<!DOCTYPE html>
<html>
<head>
	<title>Load Content By Data Attribute</title>

	<style>

		*, *:before, *:after {
			box-sizing: border-box;
		}

		body {
			font-family: 'Georgia', serif;
		}

		h1,h2,h3,h4,h5,h6 {
			font-family: 'Helvetica', Arial, sans-serif;
		}

		a {
			color: #333;
			text-decoration: none;
		}

		a:hover {
			color: #666;
		}

		.Header-heading {
			text-align: center;
		}

		.Navigation {
			list-style-type: none;
			padding: 0;
			margin: 0;
			border: 1px solid #ccc;
		}

		.Navigation > li {
			display: inline-block;
		}

		.Navigation > li:hover {
			background-color: #228b22;
		}

		.Navigation > li > a {
			padding: 1em;
			display: block;
		}

		.Navigation > li > a:hover {
			color: #fff;
		}

		.Navigation > li > a.is-negative:hover {
			background-color: #c0473d;
		}

		.Content {
			padding: 1em;
		}

		.TableView {
			display: inline-block;
			vertical-align: top;
			margin: 10px;
		}

		.TableView-divider {
			color: #fff;
			display: block;
			padding: 1em;
			background-color: #aaa;
		}
	</style>

	<script src="//cdnjs.cloudflare.com/ajax/libs/zepto/1.1.3/zepto.min.js"></script>
	<script src="../index.js"></script>
	<script src="vendor/page-hashbang.js"></script>
	<script>
		var Util = function() {};
		Util.list = function(data, wrapper, container, fn) {
		var list = [];

		$.each(data, function(key, val) {
		    list.push(fn(key,val));
		});

		$( "<div/>", {
		    "class": wrapper,
		    html: list.join("")
		}).appendTo(container);
	};
	</script>
</head>
<body>
<div class="Container">
	<header class="Header">
		<h1 class="Header-heading" data-load="heading">Byda Examples</h1>
		<nav class="Header-nav" data-load="nav">
			<ul class="Navigation">
				<li>
					<a href="/">Home</a>
				</li>
				<li>
					<a href="/page/1">Page 1</a>
				</li>
				<li>
					<a href="/page/2">Page 2</a>
				</li>
				<li>
					<a href="/periodic-table">Periodic Table</a>
				</li>
				<li>
					<a href="/failure" class="is-negative">Failure Test</a>
				</li>
			</ul>
		</nav>
	</header>

	<div class="Content" data-load="content">
		<p>
			Click on the links above to view examples of byda.
		</p>
	</div>
</div>
<script>

load.init({
	base: '/example',
	imports: false, // Set this to true to enable HTML imports
	freeze: true
});

var index = 0;

page('/', function(ctx) {
	load({view:'home.byda'}, function(flash) {
		flash.collections.counter.set('Home visits: ' + index++);
		$('#counterBtn').on('click', function() {
			page('/');
		});
	});
});

page('/page/:id', function(ctx) {
	load({view: 'page.byda'}, function(flash){
		flash.collections.page.set(ctx.params.id);
	});
});

page('/periodic-table/:row/:num', function(ctx) {
	var row = ctx.params.row;
	var num = ctx.params.num;
	load({
		view: 'chemical.byda',
		json: { 'periodic': 'includes/periodic-table.json' }
	}, function(flash, data) {
		var element = data.periodic.table[row].elements[num];
		flash.collections.heading.set('Periodic Table - ' + element.small);
		flash.collections['full-name'].set(element.name);
		flash.collections.group.set(element.group);
		flash.collections.position.set(element.position);
		flash.collections.molar.set(element.molar);
		flash.collections.number.set(element.number);
		flash.collections.electrons.set(JSON.stringify(element.electrons));
	});
});

page('/periodic-table', function() {
	load({
		view: 'list.byda',
		json: { 'periodic': 'includes/periodic-table.json' }
	}, function(flash, data) {
		flash.collections.heading.set('Periodic Table');
		$.each(data.periodic.table, function(row, value) {
			$('.Card').append('<div class="TableView TableView-divider">Row ' + row + '</div>');
			Util.list(value.elements, 'TableView', '.Card', function(key, element) {
				return '<div class="TableView-cell"><a href="/periodic-table/'+ row + '/' + key +'">' + element.name + '</a></div>';
			});
		});
	});
});


page('/failure', function(ctx) {
	load('nonsense');
});

page();

</script>

</body>
</html>