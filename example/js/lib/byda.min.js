!function(){function f(){return"[data-"+b+"]"}function g(a,b){return a?("string"==typeof a&&(a={file:a}),a.view&&(a.file="views/"+a.view+".html"),"function"==typeof b&&(a.callback=b),a.json&&(a.json="string"==typeof a.json?{"default":a.json}:a.json,a.json={req:a.json,res:{}}),h(a),void 0):g.freeze()}function h(a){var d,b=a.file;if(a.json)if(d=Object.keys(a.json.req)[0])b=a.json.req[d];else if(!b)return k(a);f&&f.readyState<4&&(f.onreadystatechange=e,f.abort());var f=new XMLHttpRequest;b=c?c+"/"+b:b,f.open("GET",b,!0),f.setRequestHeader("X-BYDA","true"),f.onreadystatechange=function(){return 4==f.readyState?200==f.status||0===f.status&&-1!=b.indexOf("file:///")?d?(response=JSON.parse(f.responseText),"default"==d?a.json.res=response:a.json.res[d]=response,delete a.json.req[d],h(a)):i(f,a):d?(console.error('Cannot return "'+d+'" data.',"Could not get: "+a.json.req[d]),delete a.json.req[d],h(a)):j(a):void 0},f.send()}function i(a,b){var c=g.flash(),d=g.flash({dom:a.responseText});c.compare(d),c.commit(),k(b)}function j(a){throw new Error("Could not get: "+a.file)}function k(b){"function"==typeof a&&a(b),b.callback&&b.callback(g.flash({condensed:!0}),b.json?b.json.res:null)}function l(a,b){this.from=a,this.to=b}function m(a){return a||(a={}),this.changes=[],this.elements={},this.list=a.dom?g.get(a.dom):g.get(),this.frozen=a.frozen||!1,this.condensed=a.condensed||!1,this.init()}var a,d,b="load",c=window.location.origin,e=function(){};l.prototype.swap=function(){this.from&&this.to&&(this.from.innerHTML=this.to.innerHTML)},m.prototype.init=function(){return this.organize(),this.condensed?this.condense():void 0},m.prototype.condense=function(){var a={};for(var b in this.elements)a[b]=1===this.elements[b].length?this.elements[b][0]:this.elements[b];return a},m.prototype.compare=function(a){var b,c,e,f,g,h;if(a&&!a.condensed&&!this.condensed){h=d?d.elements:a.elements;for(var i in h)if(this.elements[i])for(f=d?d.elements[i]:this.elements[i],g=a.elements[i]||f,b=0,c=g.length;c>b;b++)e=new l(this.elements[i][b],g[b]),this.changes.push(e);return a.changes=this.changes,this}},m.prototype.organize=function(a){var c,d,e,f;for(this.elements={},a||(a=this.list),c=0,d=a.length;d>c;c++)e=this.frozen?a[c].cloneNode(!0):a[c],f=a[c].getAttribute("data-"+b),this.elements[f]||(this.elements[f]=[]),this.elements[f].push(e);return this},m.prototype.commit=function(){var a,b;for(a=0,b=this.changes.length;b>a;a++)this.changes[a].swap()},g.init=function(d){if(d){if("string"==typeof d)return b=d,void 0;d.data&&(b=d.data),d.suffix&&(b=d.suffix),d.base&&(c=d.base),"function"==typeof d.complete&&(a=d.complete),d.freeze&&this.freeze()}},g.base=function(a){return a&&(c=a),c},g.get=function(a){var b=a?(new DOMParser).parseFromString(a,"text/html"):document;return b.querySelectorAll(f())},g.flash=function(a){return new m(a)},g.freeze=function(){return d=g.flash({frozen:!0}),console.log(f()+" elements are now frozen."),d},"undefined"==typeof module?(window.load||(window.load=g),window.byda||(window.byda=g)):module.exports=g}();